<!DOCTYPE html>
<html>
    <head>
        <title>EBA - Deployment Self Service User guides</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            EBA - Deployment Self Service User guides
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    
                    <div id="main-content" class="wiki-content group">
                    <p><style type='text/css'>/*<![CDATA[*/
div.rbtoc1455124440258 {padding: 0px;}
div.rbtoc1455124440258 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1455124440258 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1455124440258'>
<ul class='toc-indentation'>
<li><a href='#EBA-DeploymentSelfServiceUserguides-Overview-whatisSelfService?'>Overview - what is Self Service?</a></li>
<li><a href='#EBA-DeploymentSelfServiceUserguides-WhatdoIneedtocreatetodeploymycomponent,applicationorrelease?'>What do I need to create to deploy my component, application or release?</a>
<ul class='toc-indentation'>
<li><a href='#EBA-DeploymentSelfServiceUserguides-EBSAReleasePlugin'>EBSA Release Plugin</a></li>
<li><a href='#EBA-DeploymentSelfServiceUserguides-ConfigureJenkinsforSelfService'>Configure Jenkins for Self Service</a>
<ul class='toc-indentation'>
<li><a href='#EBA-DeploymentSelfServiceUserguides-Version1.5ChangestoGlobalConfiguration'>Version 1.5 Changes to Global Configuration</a></li>
</ul>
</li>
<li><a href='#EBA-DeploymentSelfServiceUserguides-Definingacomponent'>Defining a component</a>
<ul class='toc-indentation'>
<li><a href='#EBA-DeploymentSelfServiceUserguides-ConfiguringtheJenkinsjob'>Configuring the Jenkins job</a></li>
<li><a href='#EBA-DeploymentSelfServiceUserguides-buildrun'>build run</a></li>
</ul>
</li>
<li><a href='#EBA-DeploymentSelfServiceUserguides-Defininganapplication'>Defining an application</a>
<ul class='toc-indentation'>
<li><a href='#EBA-DeploymentSelfServiceUserguides-ConfiguringtheJenkinsjob.1'>Configuring the Jenkins job</a></li>
<li><a href='#EBA-DeploymentSelfServiceUserguides-Buildrun'>Build run</a></li>
</ul>
</li>
<li><a href='#EBA-DeploymentSelfServiceUserguides-Definingarelease'>Defining a release</a>
<ul class='toc-indentation'>
<li><a href='#EBA-DeploymentSelfServiceUserguides-ConfiguringtheJenkinsjob.2'>Configuring the Jenkins job</a></li>
<li><a href='#EBA-DeploymentSelfServiceUserguides-Buildrun.1'>Build run</a></li>
</ul>
</li>
<li><a href='#EBA-DeploymentSelfServiceUserguides-DefiningDeploymentDescriptors'>Defining Deployment Descriptors</a></li>
</ul>
</li>
<li><a href='#EBA-DeploymentSelfServiceUserguides-HowdoIdeploymycomponent,applicationorrelease?'>How do I deploy my component, application or release?</a>
<ul class='toc-indentation'>
<li><a href='#EBA-DeploymentSelfServiceUserguides-Deployacomponent'>Deploy a component</a>
<ul class='toc-indentation'>
<li><a href='#EBA-DeploymentSelfServiceUserguides-ConfiguringtheJenkinsjob.3'>Configuring the Jenkins job</a></li>
<li><a href='#EBA-DeploymentSelfServiceUserguides-Buildrun.2'>Build run</a></li>
</ul>
</li>
<li><a href='#EBA-DeploymentSelfServiceUserguides-Deployanapplication'>Deploy an application</a>
<ul class='toc-indentation'>
<li><a href='#EBA-DeploymentSelfServiceUserguides-ConfiguringtheJenkinsjob.4'>Configuring the Jenkins job</a></li>
<li><a href='#EBA-DeploymentSelfServiceUserguides-Buildrun.3'>Build run</a></li>
</ul>
</li>
<li><a href='#EBA-DeploymentSelfServiceUserguides-Deployarelease'>Deploy a release</a>
<ul class='toc-indentation'>
<li><a href='#EBA-DeploymentSelfServiceUserguides-ConfiguringtheJenkinsjob.5'>Configuring the Jenkins job</a></li>
<li><a href='#EBA-DeploymentSelfServiceUserguides-Buildrun.4'>Build run</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div></p><h1 id="EBA-DeploymentSelfServiceUserguides-Overview-whatisSelfService?">Overview - what is Self Service?</h1><p>Self service is a mechanism to support the deployment of applications to environments. By providing a standard user Interface it enables non-specialist, authorised individuals to easily and frequently deploy packaged applications into their own environments. A standard deployment interface for developers is provided - currently this is RPM for CentOS environments, but more generally it is whatever packaging system is on the target environment.</p><p>Key constraints that self service accounts for are:</p><ul><li>Deployments are remote: Console access to target servers is not available to deployers at deployment time (ssh sudo access is uncommon).</li><li>Deployments need to be <br /><ul><li>robust</li><li>repeatable</li><li>fast</li><li>easy</li></ul></li><li>A wide variety of technologies should be supported.</li></ul><p>An overview of how the key actors involved with using the Self Service tooling is shown below.</p><p>

<map id="gliffy-map-57514076-6973" name="gliffy-map-57514076-6973"></map>
<table width="100%" class="gliffy-macro-table">
    <tr>
        <td >
            <table class="gliffy-macro-inner-table">
                <caption align="bottom">
 </caption>

                <tr>
                    <td>
                        <img style="border: none; width: 671px;" usemap="#gliffy-map-57514076-6973" src="attachments/58294494/57514075.png" alt="" class="gliffy-macro-image"/>
                    </td>
                </tr>
            </table>
 
        </td>
    </tr>
</table>


</p><p>Self Service operates at a number of levels of complexity. These levels are explained by the diagram below.</p><p>

<map id="gliffy-map-57514074-6156" name="gliffy-map-57514074-6156"></map>
<table width="100%" class="gliffy-macro-table">
    <tr>
        <td >
            <table class="gliffy-macro-inner-table">
                <caption align="bottom">
 </caption>

                <tr>
                    <td>
                        <img style="border: none; width: 1008px;" usemap="#gliffy-map-57514074-6156" src="attachments/58294494/57514073.png" alt="" class="gliffy-macro-image"/>
                    </td>
                </tr>
            </table>
 
        </td>
    </tr>
</table>


</p><h1 id="EBA-DeploymentSelfServiceUserguides-WhatdoIneedtocreatetodeploymycomponent,applicationorrelease?">What do I need to create to deploy my component, application or release?</h1><h2 id="EBA-DeploymentSelfServiceUserguides-EBSAReleasePlugin">EBSA Release Plugin</h2><p>The Self Service component has been implemented to work with Jenkins as a Jenkins plugin (repo: EBSAT / ebsa-ci-components / ebsa-release-plugin). This plugin must be installed for any of the following function to be available.</p><h2 id="EBA-DeploymentSelfServiceUserguides-ConfigureJenkinsforSelfService">Configure Jenkins for Self Service</h2><p>Jenkins must be configured, before any Self Service operations can be performed, to know the location and properties of things such as the Release Management Repository, the Yum server(s) and the Environment Management (Self Service) tool (written in Java).</p><p>Certain global configuration is needed for the Release Management function.  It can be found in the &quot;Manage Jenkins &gt; Configure System&quot; area. Go the Configure system page, scroll down the page until you find the&quot;EBSA Release Management&quot; section.</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="411" width="912" src="attachments/25186459/25433122.png" data-image-src="attachments/25186459/25433122.png" data-unresolved-comment-count="0" data-linked-resource-id="25433122" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="GlobalConfiguration.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="25186459" data-linked-resource-container-version="19"></span></span></p><p>In this section you will be able to configure the application to connect to a database using the fields provided.  Be aware that the jp_rm_prd database is the production database and no testing systems should be connected to this database.</p><h4 id="EBA-DeploymentSelfServiceUserguides-Version1.5ChangestoGlobalConfiguration">Version 1.5 Changes to Global Configuration</h4><p>In version 1.5 (introduction of self service to NP and ST) some new Global Configuration was introduced.  The screen now looks as per the image below.  Changes are:</p><ul><li>Renamed &quot;EBSA Release Management&quot; section to &quot;EBSA Release Management Database&quot;</li><li>Added &quot;Ebsa Yum Servers&quot; section to capture the yum FQDN, scp user and scp folder for each environment.  The Ebsa YUM servers are used by the Component deployment feature.  Depending on the target environment selected by the users (e.g. &quot;st&quot; or &quot;np&quot;) it will populate the CD_YUM_SERVER, CD_YUM_SCP_USER and CD_YUM_SCP_PATH differently.  It does this by matching the environment selected to the &quot;Environment Prefix field in this configuration)</li><li>Added &quot;Ebsa Environment Management&quot; section (this is version 2.0 and is present but remains inert)</li></ul><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="904" width="930" src="attachments/25186459/25433344.png" data-image-src="attachments/25186459/25433344.png" data-unresolved-comment-count="0" data-linked-resource-id="25433344" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2014-9-24 12:7:33.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="25186459" data-linked-resource-container-version="19"></span></span></p><h2 id="EBA-DeploymentSelfServiceUserguides-Definingacomponent">Defining a component</h2><p>This shows the steps that are taken to define a component, at a given version, in the Release Management Repository. This component is then available to be deployed either individually (<a href="#EBA-DeploymentSelfServiceUserguides-Deployacomponent">Deploy a component</a>), as part of an application (<a href="#EBA-DeploymentSelfServiceUserguides-Deployanapplication">Deploy an application</a>), or as part of a full system release (<a href="#EBA-DeploymentSelfServiceUserguides-Deployarelease">Deploy a release</a>).</p><h3 id="EBA-DeploymentSelfServiceUserguides-ConfiguringtheJenkinsjob">Configuring the Jenkins job</h3><p>In Jenkins, &quot;<strong>New Item</strong>&quot; =&gt; &quot;<strong>Build a free-style software project</strong>&quot; =&gt; &quot;<strong>Add build step</strong>&quot; (Release a new version of IPT Component) =&gt; <em><strong>Provide Build options</strong></em> =&gt; &quot;<strong>Save</strong></p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="338" width="365" src="attachments/25186459/25433094.png" data-image-src="attachments/25186459/25433094.png" data-unresolved-comment-count="0" data-linked-resource-id="25433094" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="CreateAComponentVersion add a build step.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="25186459" data-linked-resource-container-version="19"></span></span></p><p>Build step options</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="412" width="749" src="attachments/25186459/25433095.png" data-image-src="attachments/25186459/25433095.png" data-unresolved-comment-count="0" data-linked-resource-id="25433095" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="CreateAComponentVersion build step.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="25186459" data-linked-resource-container-version="19"></span></span></p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><strong>Note</strong>: the ${VARIABLE_NAME} declarations, this shows that we can use environment variable substitution.  One use of this is to add parameters to the build and use the values of the parameters in the build step.  Note the last field is a drop-down.  This drop-down allows the user to select the application for which they will be making ComponentVersions.</span></p><h3 id="EBA-DeploymentSelfServiceUserguides-buildrun">build run</h3><p>When we build this job it will use the values in the configuration fields to create a new row in the ComponentVersion table.<br />The following log extracts form the job console shows some of the output.</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="477" width="1410" src="attachments/25186459/25433124.png" data-image-src="attachments/25186459/25433124.png" data-unresolved-comment-count="0" data-linked-resource-id="25433124" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="CreateAComponentVersion log.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="25186459" data-linked-resource-container-version="19"></span></span></p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><br /></span></p><h2 id="EBA-DeploymentSelfServiceUserguides-Defininganapplication">Defining an application</h2><p>This shows the steps that are taken to define an application, at a given version, in the Release Management Repository. An application is defined as a collection of components each at a specified version. The application itself is also versioned. This application is then available to be deployed either individually (<a href="#EBA-DeploymentSelfServiceUserguides-Deployanapplication">Deploy an application</a>) or as part of a full system release (<a href="#EBA-DeploymentSelfServiceUserguides-Deployarelease">Deploy a release</a>).</p><h3 id="EBA-DeploymentSelfServiceUserguides-ConfiguringtheJenkinsjob.1">Configuring the Jenkins job</h3><p>In Jenkins, &quot;<strong>New Item</strong>&quot; =&gt; &quot;<strong>Build a free-style software project</strong>&quot; =&gt; &quot;<strong>This build is parameterised</strong>&quot; (Add parameter &quot;IPT Application Version patameter&quot;) =&gt; &quot;<strong>Add build step</strong>&quot; (Release a new version of an IPT Application) =&gt; &quot;<strong>Save</strong>&quot;</p><p><span class="confluence-embedded-file-wrapper"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-external-resource" src="attachments/25186459/25433104.png" data-image-src="https://<confluenceurl>/download/attachments/25186459/CreateAnApplicationVersion%20add%20a%20Parameter.png?version=1&amp;modificationDate=1411476589000&amp;api=v2"></span></span></p><p>Note: In order to show the application drop down, save the job and come back to Job configuration There is a known bug that needs to be fixed which will remove this step</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource confluence-content-image-border" height="136" width="961" src="attachments/25186459/25433106.png" data-image-src="https://<confluenceurl>/download/attachments/25186459/CreateAnApplicationVersion%20configureParameter.png?version=1&amp;modificationDate=1411476707000&amp;api=v2"></span></span></p><p>Build step options<br /><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource confluence-content-image-border" height="338" width="329" src="attachments/25186459/25433107.png" data-image-src="https://<confluenceurl>/download/attachments/25186459/CreateAnApplicationVersion%20add%20a%20BuildStep.png?version=1&amp;modificationDate=1411476781000&amp;api=v2"></span></span></p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource confluence-content-image-border" height="95" width="757" src="attachments/25186459/25433108.png" data-image-src="https://<confluenceurl>/download/attachments/25186459/CreateAnApplicationVersion%20configureBuildStep.png?version=1&amp;modificationDate=1411476893000&amp;api=v2"></span></span></p><h3 id="EBA-DeploymentSelfServiceUserguides-Buildrun"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size">Build run<br /></span></h3><p>When you click on &quot;<strong>Build with parameters</strong>&quot;. You'll see a screen similar to the screenshot below.<br /><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource confluence-content-image-border" height="1204" width="1080" src="attachments/25186459/25433109.png" data-image-src="https://<confluenceurl>/download/attachments/25186459/CreateAnApplicationVersion%20buildWithParameters.png?version=1&amp;modificationDate=1411477150000&amp;api=v2"></span></span></p><p>In the first section, enter some details about the new application version.</p><p>Select the versions of the components associated with the IPT Application that you have selected during configuration.  Next to each of the components will be a list of each of the versions for that component. If you wish to exclude a component from an application, just change the value to &quot;--&quot;.</p><p>Click &quot;<strong>Build</strong>&quot;<br />A new row is placed in the ApplicationVersion table of the release database. This new application version can then be used later in deploying it in an actual environment</p><p>An example output of this job is shown below</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource confluence-content-image-border" height="375" width="1500" src="attachments/25186459/25433110.png" data-image-src="https://<confluenceurl>/download/attachments/25186459/CreateAnApplicationVersion%20log.png?version=1&amp;modificationDate=1411477360000&amp;api=v2"></span></span></p><h2 id="EBA-DeploymentSelfServiceUserguides-Definingarelease">Defining a release</h2><p>This shows the steps that are taken to define a release, at a given version, in the Release Management Repository. A release is defined as a collection of versioned applications, each of which consist of a collection of versioned components. The release itself is also versioned. This release is then available to be deployed (<a href="#EBA-DeploymentSelfServiceUserguides-Deployarelease">Deploy a release</a>).</p><h3 id="EBA-DeploymentSelfServiceUserguides-ConfiguringtheJenkinsjob.2">Configuring the Jenkins job</h3><p>In Jenkins, &quot;<strong>New Item</strong>&quot; =&gt; &quot;<strong>Build a free-style software project</strong>&quot; =&gt; &quot;<strong>This build is parameterised</strong>&quot; (Add parameter &quot;IPT Composite Release Parameter&quot;) =&gt; &quot;<strong>Add build step</strong>&quot; (Release a new version of an IPT Composite Release) =&gt; &quot;<strong>Save</strong>&quot;</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="250" src="attachments/41489118/41489308.png" data-image-src="https://<confluenceurl>/download/attachments/41489118/image2015-7-2%2013%3A52%3A41.png?version=1&amp;modificationDate=1435841562118&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="41489308" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2015-7-2 13:52:41.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="41489118" data-linked-resource-container-version="11"></span></span></p><p><span class="confluence-embedded-file-wrapper"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="attachments/41489118/41489316.png" data-image-src="https://<confluenceurl>/download/attachments/41489118/image2015-7-2%2013%3A56%3A57.png?version=1&amp;modificationDate=1435841817824&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="41489316" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2015-7-2 13:56:57.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="41489118" data-linked-resource-container-version="11"></span></span></p><h3 id="EBA-DeploymentSelfServiceUserguides-Buildrun.1"><span class="confluence-embedded-file-wrapper">Build run<br /></span></h3><p>When you click on &quot;<strong>Build with parameters</strong>&quot;. You'll see a screen similar to the screenshot below.<br /><span class="confluence-embedded-file-wrapper"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="attachments/41489118/41489324.png" data-image-src="https://<confluenceurl>/download/attachments/41489118/image2015-7-2%2014%3A1%3A50.png?version=1&amp;modificationDate=1435842110518&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="41489324" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2015-7-2 14:1:50.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="41489118" data-linked-resource-container-version="11"></span></span></p><p>In the &quot;<strong>Basic IPT Release Details</strong>&quot; section, enter some details about the new Composite Release Version.Validation is applied, for example, to check that the version number matches the format x.x.x (eg, 1.0.23).<br />The &quot;<strong>Application Versions</strong>&quot; section is initially empty. To add an application version to the release:<br />    Select an Application from the drop down<br />    Then select an application version<br />    Then click &quot;<strong>Add Application Version</strong>&quot;<em><br /><span class="confluence-embedded-file-wrapper"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="attachments/41489118/41489433.png" data-image-src="https://<confluenceurl>/download/attachments/41489118/image2015-7-2%2015%3A23%3A38.png?version=1&amp;modificationDate=1435847018510&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="41489433" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2015-7-2 15:23:38.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="41489118" data-linked-resource-container-version="11"></span></span></em></p><p>When you have added the required application versions, click &quot;<strong>Build</strong>&quot;, A new row is placed in the ReleaseVersion table of the release database. This new Composite Release Version can then be used in an environment for a release.</p><p>An example of the job output is shown below</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="400" src="attachments/41489118/41489440.png" data-image-src="https://<confluenceurl>/download/attachments/41489118/image2015-7-2%2015%3A28%3A52.png?version=1&amp;modificationDate=1435847332725&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="41489440" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2015-7-2 15:28:52.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="41489118" data-linked-resource-container-version="11"></span></span></p><h2 id="EBA-DeploymentSelfServiceUserguides-DefiningDeploymentDescriptors">Defining Deployment Descriptors</h2><p>Application Deployment Descriptors are XML files which define the components that make up an application, as well as the steps required to fully deploy those components into any environment in the correct order. Similarly Composite Release Deployment Descriptors are simple XML documents to describe the order in which to release Applications. <span>These should only be accessible by DevOps resources within each team.</span></p><p>The Deployment Descriptors are stored in Stash (Application DD: <span class="external-link">EBSA Tooling / <span>environmentdeploymentdescriptors</span></span> &amp; Release DD:  <span class="external-link">EBSA Tooling / releasedeploymentdescriptors</span> )and must follow a strict set of guidelines ( XSDs: <span>EBSAT / ebsa-ci-components / deployment-descriptor-schema</span> )</p><p>Before an application or release can be deployed, we need to ensure that respective Deployment Descriptor has been created stored in stash. More information to generate the xml is described in separate pages. <a href="Application-Deployment-Descriptor-Guide_26977173.html">Application DD</a> &amp; <a href="Composite-Release-Deployment-Descriptor_42828290.html">Release DD</a></p><h1 id="EBA-DeploymentSelfServiceUserguides-HowdoIdeploymycomponent,applicationorrelease?">How do I deploy my component, application or release?</h1><p>Once the component, application, release definitions are completed (i.e., an entry in the Release Management Database). There are individual jobs to kick off the build which does the deployments (a particular version) to an environment. Deployment for component, application &amp; release are mentioned below.</p><h2 id="EBA-DeploymentSelfServiceUserguides-Deployacomponent">Deploy a component</h2><h3 id="EBA-DeploymentSelfServiceUserguides-ConfiguringtheJenkinsjob.3">Configuring the Jenkins job</h3><p>In Jenkins, &quot;<strong>New Item</strong>&quot; =&gt; &quot;<strong>Build a free-style software project</strong>&quot; =&gt; &quot;<strong>This build is parameterised</strong>&quot; (Add parameter &quot;IPT Component Deployment parameter&quot;) =&gt; &quot;<strong>Add build step</strong>&quot; (&quot;Trigger a remote parameterized job&quot;) =&gt; &quot;<strong>Add build step</strong>&quot; (&quot;Execute shell&quot;) =&gt; &quot;<strong>Save</strong>&quot;</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="366" width="245" src="attachments/25186459/25433134.png" data-image-src="attachments/25186459/25433134.png" data-unresolved-comment-count="0" data-linked-resource-id="25433134" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="DeployComponent add a Parameter.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="25186459" data-linked-resource-container-version="19"></span></span></p><p>The parameter is configured by selecting an Application and by putting in a location where the Hieradata files can be loaded.<br />The hieradata files are taken straight out of GIT and on the CI Jenkins we have a job (EBSA_TOOLS_PUPPETHIERADB_FETCH) which fetches the latest hieradata from GIT every 1 minute or so.</p><ul><li>The Puppet Hieradata location provides the dataset for the environment selection.</li><li>The Application provides the dataset for the ComponentVersion selection</li></ul><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="156" width="716" src="attachments/25186459/25433135.png" data-image-src="attachments/25186459/25433135.png" data-unresolved-comment-count="0" data-linked-resource-id="25433135" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="DeployComponent configureParameter.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="25186459" data-linked-resource-container-version="19"></span></span></p><p>Build step options</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="324" width="367" src="attachments/25186459/25433136.png" data-image-src="attachments/25186459/25433136.png" data-unresolved-comment-count="0" data-linked-resource-id="25433136" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="DeployComponent add a RemoteBuildStep.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="25186459" data-linked-resource-container-version="19"></span></span></p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="554" width="1475" src="attachments/25186459/25433137.png" data-image-src="attachments/25186459/25433137.png" data-unresolved-comment-count="0" data-linked-resource-id="25433137" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="DeployComponent configureRemoteJob.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="25186459" data-linked-resource-container-version="19"></span></span></p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="314" width="340" src="attachments/25186459/25433139.png" data-image-src="attachments/25186459/25433139.png" data-unresolved-comment-count="0" data-linked-resource-id="25433139" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="DeployComponent add a EXECUTEStep.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="25186459" data-linked-resource-container-version="19"></span></span></p><p>and configure it as below.  This will fetch the log from the remote server so that the user can see what happened.</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="197" width="1466" src="attachments/25186459/25433140.png" data-image-src="attachments/25186459/25433140.png" data-unresolved-comment-count="0" data-linked-resource-id="25433140" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="DeployComponent configureFetchLog.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="25186459" data-linked-resource-container-version="19"></span></span></p><h3 id="EBA-DeploymentSelfServiceUserguides-Buildrun.2">Build run</h3><p>When the user selects &quot;Build with parameters&quot; they will be presented with the screen below.  They need to select an version of a component, as well as a environment and a role.</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" height="1400" width="1188" src="attachments/25186459/25433141.png" data-image-src="attachments/25186459/25433141.png" data-unresolved-comment-count="0" data-linked-resource-id="25433141" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="DeployComponent buildWithParameters.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="25186459" data-linked-resource-container-version="19"></span></span></p><p>When they click &quot;Build&quot; the component they selected will be deployed to the environment that they selected.<br />The &quot;Role details&quot; in the screen shot above shows the software which can be found in the &quot;system:: packages&quot; section of the yaml file in the roel drop down.  It is there for convenience purposes so that the user can use it as a reference when they have selected an environment.</p><p><strong>Outputs</strong></p><p>The Component Deploy facility produces three outputs. </p><ul><li>The first is a set of environment variables which get set in the build which contain information relating to the users choices and other environmental factors.  These environment variables are used by follow on build steps to pass data to downstream processes.</li><li>The second is a properties file called &quot;deploy.properties&quot; which it writes into the job workspace folder.  This contains a listing of all of the properties for the build, including those which have been added by the process.  This file provides a great way of knowing the exact values which the tool outputs and can be used during testing to quickly validate certain outputs without having to execute the rest of the downstream processes.</li><li>The third output is a csv file called &lt;uuid&gt;.csv (where uuid is a universally unique identifier) which contains a comma separated set of values which can be used as input to the createrepo-q-tool to populate the yum repository.</li></ul><h2 id="EBA-DeploymentSelfServiceUserguides-Deployanapplication">Deploy an application</h2><h3 id="EBA-DeploymentSelfServiceUserguides-ConfiguringtheJenkinsjob.4">Configuring the Jenkins job</h3><p>In Jenkins, &quot;<strong>New Item</strong>&quot; =&gt; &quot;<strong>Build a free-style software project</strong>&quot; =&gt; &quot;<strong>This build is parameterised</strong>&quot; (Add parameter &quot;IPT Application Version Deployment Parameters&quot;) =&gt; &quot;<strong>Add build step</strong>&quot; (&quot;IPT Application Deployment&quot;) =&gt; &quot;<strong>Save</strong>&quot;</p><p><span class="confluence-embedded-file-wrapper"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="attachments/26161192/26250203.png" data-image-src="https://<confluenceurl>/download/attachments/26161192/image2014-10-24%2011%3A51%3A40.png?version=1&amp;modificationDate=1414147900000&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="26250203" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2014-10-24 11:51:40.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="26161192" data-linked-resource-container-version="13"></span></span></p><p> </p><p><span> </span><span>Note: In order to show the application dropdown, save the job and come back to Job configuration There is a known bug that needs to be fixed which will remove this step</span></p><p> </p><p> </p><p>For the value of the &quot;<strong>Work folder</strong>&quot;, put the location of the job's workspace. This will be <em><strong>/var/lib/jenkins/jobs/&lt;name of the</strong></em><strong> job</strong><span class="confluence-embedded-file-wrapper"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="attachments/26161192/26250227.png" data-image-src="https://<confluenceurl>/download/attachments/26161192/image2014-10-24%2013%3A37%3A53.png?version=1&amp;modificationDate=1414154273000&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="26250227" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2014-10-24 13:37:53.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="26161192" data-linked-resource-container-version="13"></span></span></p><p>build steps<br /><span class="confluence-embedded-file-wrapper"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="attachments/26161192/26250231.png" data-image-src="https://<confluenceurl>/download/attachments/26161192/image2014-10-24%2013%3A42%3A23.png?version=1&amp;modificationDate=1414154544000&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="26250231" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2014-10-24 13:42:23.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="26161192" data-linked-resource-container-version="13"></span></span><br /><br /></p><p>OPTIONAL STEP: You may wish to set the deployment as a &quot;Prepare only&quot; job. This will do all the work to figure out what would be deployed, but won't actually do the deployment. To enable this, click advanced under &quot;IPT Application Deployment&quot; select the &quot;Prepare only&quot; checkbox</p><h3 id="EBA-DeploymentSelfServiceUserguides-Buildrun.3">Build run</h3><p>Open the job and click &quot;<strong>Build with parameters</strong>&quot;, select the application you would like to deploy:<br /><span class="confluence-embedded-file-wrapper"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="attachments/26161192/26250247.png" data-image-src="https://<confluenceurl>/download/attachments/26161192/image2014-10-24%2014%3A1%3A16.png?version=1&amp;modificationDate=1414155677000&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="26250247" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2014-10-24 14:1:16.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="26161192" data-linked-resource-container-version="13"></span></span><br />As an example, we've opted to deploy an application called &quot;Strawberry 1.0&quot;. Jenkins has shown us the components that will be deployed with that component:<br /><span class="confluence-embedded-file-wrapper"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="attachments/26161192/26250248.png" data-image-src="https://<confluenceurl>/download/attachments/26161192/image2014-10-24%2014%3A2%3A21.png?version=1&amp;modificationDate=1414155742000&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="26250248" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2014-10-24 14:2:21.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="26161192" data-linked-resource-container-version="13"></span></span></p><p>Next select the environment you would like to deploy to. We've selected <em>DEV1-EBS2</em> in this example:<br /><span class="confluence-embedded-file-wrapper"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="attachments/26161192/26250249.png" data-image-src="https://<confluenceurl>/download/attachments/26161192/image2014-10-24%2014%3A3%3A14.png?version=1&amp;modificationDate=1414155795000&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="26250249" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2014-10-24 14:3:14.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="26161192" data-linked-resource-container-version="13"></span></span></p><p>Click the &quot;<strong>Generate deployment plan</strong>&quot; button.</p><p>There are two outcomes here: the deployment plan is either generated successfully or an error occurs. Read the next section about the outputs.</p><p><u><strong>Output of the Deployment Plan</strong></u></p><p>There are 6 sections to the deployment plan output:</p><ul><li>Deployment Plan</li><li>Dependency chains</li><li>Transitions</li><li>Deployment Descriptor</li><li>Log</li><li>Errors or Next Steps</li></ul><p>If the deployment plan is successful, there the &quot;Next Steps&quot; heading with a &quot;<strong>Build</strong>&quot; button will be shown. </p><p>If the deployment plan is unsuccessful, the errors section will be shown with the cause of the error.</p><p>The sections above contain the following information:</p><p><strong>Deployment Plan:</strong></p><p>Contains the list of components that will be deployed, their target version and existing version and the action that will be taken (e.g. DEPLOY, UPGRADE, DOWNGRADE).</p><p>If any errors occur, they'll appear in this step in red.</p><p><strong>Dependency chains:</strong></p><p>This shows a tree of dependencies, for instance:</p><p><span class="confluence-embedded-file-wrapper"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="attachments/26161192/26250271.png" data-image-src="https://<confluenceurl>/download/attachments/26161192/image2014-10-24%2014%3A33%3A1.png?version=1&amp;modificationDate=1414157581000&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="26250271" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2014-10-24 14:33:1.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="26161192" data-linked-resource-container-version="13"></span></span></p><p>This shows that <em>CommonConfigRPM</em> depends on all the other components on this application, and (for instance) <em>IPTBatchHandler</em> has no dependencies, but that <em>IPTFulfilmentManagement</em> is dependent on the <em>IPTBatchHandler</em>.</p><p><strong>Transitions</strong></p><p>The transitions table will show the 1 or more transitions that will be applied, and what will be changed in those transitions.</p><p><strong>Deployment Descriptor</strong></p><p><strong>Log</strong></p><p>The log is the log of the application that determines the dependencies and transition plan. If any errors occur, we'll most likely use this log to determine the problem. </p><p><strong>Errors</strong></p><p>If any errors occur, they'll appear here. This will identify the specific problem that occurred that prevented the deployment plan being created.</p><p><strong>Next Steps</strong></p><p>If the deployment plan is successful, the following will be shown:<br /><span class="confluence-embedded-file-wrapper"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="attachments/26161192/26250272.png" data-image-src="https://<confluenceurl>/download/attachments/26161192/image2014-10-24%2014%3A38%3A16.png?version=1&amp;modificationDate=1414157896000&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="26250272" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2014-10-24 14:38:16.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="26161192" data-linked-resource-container-version="13"></span></span> </p><p><strong>Deployment Plan Successfully Generated: Deploying your application <span class="confluence-anchor-link"> </span></strong></p><p>If all goes to plan, your deployment plan will be successfully generated.</p><p>Firstly, please check all the details of the plan. Check the transitions to make sure they're sensible and confirm that all the applications you need are deployed.</p><p>If (and only if) you're happy, click the &quot;<strong>Build</strong>&quot; button.</p><h2 id="EBA-DeploymentSelfServiceUserguides-Deployarelease">Deploy a release</h2><h3 id="EBA-DeploymentSelfServiceUserguides-ConfiguringtheJenkinsjob.5">Configuring the Jenkins job</h3><h3 id="EBA-DeploymentSelfServiceUserguides-Buildrun.4">Build run</h3><p><span>When you are ready to deploy a Composite Release, click &quot;</span><strong>Build with parameters</strong><span>&quot;. You'll see a screen similar to the screenshot below.<br /></span><span><span class="confluence-embedded-file-wrapper"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="attachments/41489118/42827841.png" data-image-src="https://<confluenceurl>/download/attachments/41489118/image2015-7-14%2014%3A47%3A18.png?version=1&amp;modificationDate=1436881638841&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="42827841" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2015-7-14 14:47:18.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="41489118" data-linked-resource-container-version="11"></span></span></span><span> </span></p><p><span>In the &quot;<strong>Deployment Configuration</strong>&quot; section, select a &quot; <strong>Release Version</strong>&quot;. The details for the selected release version will be shown, including the application versions to be included in the release. The plus icon (<span class="confluence-embedded-file-wrapper"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="attachments/41489118/42827842.png" data-image-src="https://<confluenceurl>/download/attachments/41489118/image2015-7-14%2014%3A49%3A45.png?version=1&amp;modificationDate=1436881786042&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="42827842" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2015-7-14 14:49:45.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="41489118" data-linked-resource-container-version="11"></span></span>) can be used to expand the information for an application, to show the component versions that are included.</span><br /><span class="confluence-embedded-file-wrapper"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="attachments/41489118/42827808.png" data-image-src="https://<confluenceurl>/download/attachments/41489118/image2015-7-14%2014%3A5%3A54.png?version=1&amp;modificationDate=1436879154732&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="42827808" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2015-7-14 14:5:54.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="41489118" data-linked-resource-container-version="11"></span></span></p><p>Select an &quot;<strong>Environment</strong>&quot; to deploy to and &quot;<strong>Deployment Descriptor</strong>&quot; to use for this deployment, then select any &quot;<strong>Advanced</strong>&quot; options required.</p><p>Click &quot;<strong>Generate deployment plan</strong>&quot; and Self Service will analyse the information given to produce a deployment plan.<br />The deployment plan includes information about -</p><p>Which applications will be deployed, including a summary of component upgrades/downgrades/deployments/undeployments. This can be expanded to show more information about the specific components involved.</p><p>How the applications will be deployed (under the &quot;<strong>Phases</strong>&quot; section). Each phase will consist of one or more transitions, which should be familiar to Self Service 2.0 users.</p><p>The <strong>Dependencies</strong> of tree, showing the dependencies between components for each application.</p><p>The log from Self Service used for debugging.</p><p><span class="confluence-embedded-file-wrapper"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="attachments/41489118/42828239.png" data-image-src="https://<confluenceurl>/download/attachments/41489118/image2015-7-14%2017%3A16%3A13.png?version=1&amp;modificationDate=1436890573903&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="42828239" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2015-7-14 17:16:13.png" data-base-url="https://<confluenceurl>" data-linked-resource-content-type="image/png" data-linked-resource-container-id="41489118" data-linked-resource-container-version="11"></span></span></p><p>After reviewing the deployment plan, click &quot;<strong>Build</strong>&quot; to start the deployment. The deployment plan will be written to the workspace, and can be opened to view progress. Specifically, as the deployment progresses, indicators will be displayed to show which transitions have been executed, which are currently running and which are yet to be run.</p>
                    </div>

                                        
                    
                 
                </div>             </div> 
            
        </div>     </body>
</html>
